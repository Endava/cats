openapi: 3.0.0
info:
  title: Test OneOf with Properties
  version: 1.0.0
paths:
  /test:
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AtomicValue'
      responses:
        '200':
          description: Success
components:
  schemas:
    AtomicValue:
      properties:
        kind:
          $ref: "#/components/schemas/AtomicValueKind"
        bubulel:
          type: string
      oneOf:
        - $ref: "#/components/schemas/StringValue"
        - $ref: "#/components/schemas/IntValue"
      discriminator:
        propertyName: kind
        mapping:
          STRING_VALUE: "#/components/schemas/StringValue"
          INT_VALUE: "#/components/schemas/IntValue"

    AtomicValueKind:
      type: string
      enum:
        - STRING_VALUE
        - INT_VALUE

    StringValue:
      type: object
      required:
        - kind
        - value
      properties:
        kind:
          $ref: "#/components/schemas/AtomicValueKind"
        value:
          type: string

    IntValue:
      type: object
      required:
        - kind
        - value
      properties:
        kind:
          $ref: "#/components/schemas/AtomicValueKind"
        value:
          type: integer
